(self.webpackChunktest_ng12=self.webpackChunktest_ng12||[]).push([[589],{7589:function(t,e,n){"use strict";n.r(e),n.d(e,{PaymentModule:function(){return v}});var r=n(1116),o=n(7773),a=n(3464),i=n(5366);let s=(()=>{class t{constructor(){this.totalPayment=0}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-payment-completion"]],inputs:{totalPayment:["amount","totalPayment"],orderId:["order","orderId"]},decls:8,vars:5,consts:[[1,"payment-completion"],[1,"payment-completion__total-payment","mat-display-1"],[1,"payment-completion__msg"],[1,"payment-completion__method"],[3,"amount","order"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._uU(2),i.ALo(3,"currency"),i.qZA(),i.TgZ(4,"div",2),i._uU(5," Please complete your payment in order process your order! "),i.qZA(),i.TgZ(6,"div",3),i._UZ(7,"app-payment-paypal",4),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.hij(" Total Payment: ",i.lcZ(3,3,e.totalPayment)," "),i.xp6(5),i.Q6J("amount",e.totalPayment)("order",e.orderId))},styles:[".payment-completion[_ngcontent-%COMP%]{background-color:#fff;padding:1rem 1.5rem;display:grid;border-bottom-color:#ccc;border-bottom-style:solid;grid-gap:1rem;gap:1rem;justify-items:center}.payment-completion__method[_ngcontent-%COMP%]{width:25%}"]}),t})();var p=n(7570),c=n(529),m=n(6694);const l=["paypal"];let d=(()=>{class t{constructor(t,e){this.paymentService=t,this.orderService=e,this.subscriptions=new p.w,this.totalPayment=0}ngOnInit(){this.subscriptions=this.paymentService.paypalInitiate(c.N.paypalClientId).subscribe(()=>{this.genPayPalButtons(this.orderService,this.totalPayment,this.orderId)})}genPayPalButtons(t,e,n){paypal.Buttons({style:{color:"blue",shape:"pill",label:"pay",height:40,width:100},createOrder:function(t,n){return n.order.create({purchase_units:[{amount:{value:e}}],application_context:{shipping_preference:"NO_SHIPPING"}})},onApprove:function(e,r){return r.order.capture().then(function(e){"COMPLETED"==e.status&&(t.paid(n),console.log("Transaction completed by "+e.payer.name.given_name+"!"))})}}).render(this.paypalElement.nativeElement)}ngOnDestroy(){this.subscriptions.unsubscribe(),this.paymentService.paypalRemove()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(m.te),i.Y36(m.px))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-payment-paypal"]],viewQuery:function(t,e){if(1&t&&i.Gf(l,7),2&t){let t;i.iGM(t=i.CRH())&&(e.paypalElement=t.first)}},inputs:{totalPayment:["amount","totalPayment"],orderId:["order","orderId"]},decls:2,vars:0,consts:[["paypal",""]],template:function(t,e){1&t&&i._UZ(0,"div",null,0)},styles:[""]}),t})(),u=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-payment-confirmation"]],decls:8,vars:0,consts:[[1,"payment-confirmation"],[1,"payment-confirmation__msg-confirmed","mat-display-1"],[1,"payment-confirmation__msg-email"],[1,"payment-confirmation__customer"],["href",""]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._uU(2," Your order is confirmed! "),i.qZA(),i.TgZ(3,"div",2),i._uU(4," You'll receive a confirmation email with your order number shortly. "),i.qZA(),i.TgZ(5,"div",3),i.TgZ(6,"a",4),i._uU(7,"Continue Shopping"),i.qZA(),i.qZA(),i.qZA())},styles:[".payment-confirmation[_ngcontent-%COMP%]{background-color:#fff;padding:1rem 1.5rem;display:grid;border-bottom-color:#ccc;border-bottom-style:solid;justify-items:center;grid-gap:1rem;gap:1rem}"]}),t})();function y(t,e){if(1&t&&i._UZ(0,"app-payment-completion",3),2&t){const t=i.oxw();i.Q6J("amount",t.totalPayment)("order",t.orderId)}}function g(t,e){1&t&&i._UZ(0,"app-payment-confirmation")}let f=(()=>{class t{constructor(t,e){this.orderService=t,this.route=e,this.subscription=new p.w,this.totalPayment=0}ngOnInit(){this.route.params.subscribe(t=>{this.orderId=t.id,this.subscription.add(this.getOrder(this.orderId))})}getOrder(t){this.orderService.getOrderQuery(t).valueChanges.subscribe(({data:t})=>{t.allShoporder.edges.forEach(t=>{console.log("getOrder",t.node),this.totalPayment=t.node.totalAmount,this.paymentStatus=t.node.status})})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(m.px),i.Y36(a.gz))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-payment-main"]],decls:3,vars:2,consts:[[1,"payment-main"],[3,"amount","order",4,"ngIf"],[4,"ngIf"],[3,"amount","order"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.YNc(1,y,1,2,"app-payment-completion",1),i.YNc(2,g,1,0,"app-payment-confirmation",2),i.qZA()),2&t&&(i.xp6(1),i.Q6J("ngIf","Waiting For Payment"==e.paymentStatus),i.xp6(1),i.Q6J("ngIf","Paid"==e.paymentStatus))},styles:[".payment-main[_ngcontent-%COMP%]{display:grid;margin:1rem 2.5rem;grid-gap:.8rem;gap:.8rem}"]}),t})();const h=[{path:"payment/:id",component:f}];let _=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[a.Bz.forChild(h)],a.Bz]}),t})(),v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[r.ez,_,o.m]]}),t})();i.B6R(f,[r.O5,s,u],[]),i.B6R(s,[d],[r.H9])}}]);