"use strict";(self.webpackChunksfayn=self.webpackChunksfayn||[]).push([[936],{5936:(T,y,r)=>{r.r(y),r.d(y,{PaymentModule:()=>S});var p=r(9808),P=r(6182),s=r(4521),t=r(5e3);let d=(()=>{class n{constructor(){this.totalPayment=0}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-completion"]],inputs:{totalPayment:["amount","totalPayment"],orderId:["order","orderId"]},decls:8,vars:5,consts:[[1,"payment-completion"],[1,"payment-completion__total-payment","mat-display-1"],[1,"payment-completion__msg"],[1,"payment-completion__method"],[3,"amount","order"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.ALo(3,"currency"),t.qZA(),t.TgZ(4,"div",2),t._uU(5," Please complete your payment in order process your order! "),t.qZA(),t.TgZ(6,"div",3),t._UZ(7,"app-payment-paypal",4),t.qZA()()),2&e&&(t.xp6(2),t.hij(" Total Payment: ",t.lcZ(3,3,a.totalPayment)," "),t.xp6(5),t.Q6J("amount",a.totalPayment)("order",a.orderId))},styles:[".payment-completion[_ngcontent-%COMP%]{background-color:#fff;padding:1rem 1.5rem;display:grid;border-bottom-color:#ccc;border-bottom-style:solid;grid-gap:1rem;gap:1rem;justify-items:center}.payment-completion__method[_ngcontent-%COMP%]{width:25%}"]}),n})();var u=r(727),h=r(2340),c=r(5414);const C=["paypal"];let v=(()=>{class n{constructor(e,a){this.paymentService=e,this.orderService=a,this.subscriptions=new u.w0,this.totalPayment=0}ngOnInit(){this.subscriptions=this.paymentService.paypalInitiate(h.N.paypalClientId).subscribe(()=>{this.genPayPalButtons(this.orderService,this.totalPayment,this.orderId)})}genPayPalButtons(e,a,i){paypal.Buttons({style:{color:"blue",shape:"pill",label:"pay",height:40,width:100},createOrder:function(m,l){return l.order.create({purchase_units:[{amount:{value:a}}],application_context:{shipping_preference:"NO_SHIPPING"}})},onApprove:function(m,l){return l.order.capture().then(function(g){"COMPLETED"==g.status&&(e.paid(i),console.log("Transaction completed by "+g.payer.name.given_name+"!"))})}}).render(this.paypalElement.nativeElement)}ngOnDestroy(){this.subscriptions.unsubscribe(),this.paymentService.paypalRemove()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.te),t.Y36(c.px))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-paypal"]],viewQuery:function(e,a){if(1&e&&t.Gf(C,7),2&e){let i;t.iGM(i=t.CRH())&&(a.paypalElement=i.first)}},inputs:{totalPayment:["amount","totalPayment"],orderId:["order","orderId"]},decls:2,vars:0,consts:[["paypal",""]],template:function(e,a){1&e&&t._UZ(0,"div",null,0)},styles:[""]}),n})(),b=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-confirmation"]],decls:8,vars:0,consts:[[1,"payment-confirmation"],[1,"payment-confirmation__msg-confirmed","mat-display-1"],[1,"payment-confirmation__msg-email"],[1,"payment-confirmation__customer"],["href",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2," Your order is confirmed! "),t.qZA(),t.TgZ(3,"div",2),t._uU(4," You'll receive a confirmation email with your order number shortly. "),t.qZA(),t.TgZ(5,"div",3)(6,"a",4),t._uU(7,"Continue Shopping"),t.qZA()()())},styles:[".payment-confirmation[_ngcontent-%COMP%]{background-color:#fff;padding:1rem 1.5rem;display:grid;border-bottom-color:#ccc;border-bottom-style:solid;justify-items:center;grid-gap:1rem;gap:1rem}"]}),n})();function I(n,o){if(1&n&&t._UZ(0,"app-payment-completion",3),2&n){const e=t.oxw();t.Q6J("amount",e.totalPayment)("order",e.orderId)}}function M(n,o){1&n&&t._UZ(0,"app-payment-confirmation")}let f=(()=>{class n{constructor(e,a){this.orderService=e,this.route=a,this.subscription=new u.w0,this.totalPayment=0}ngOnInit(){this.route.params.subscribe(e=>{this.orderId=e.id,this.subscription.add(this.getOrder(this.orderId))})}getOrder(e){this.orderService.getOrderQuery(e).valueChanges.subscribe(({data:a})=>{a.allShoporder.edges.forEach(m=>{console.log("getOrder",m.node),this.totalPayment=m.node.totalAmount,this.paymentStatus=m.node.status})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.px),t.Y36(s.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-main"]],decls:3,vars:2,consts:[[1,"payment-main"],[3,"amount","order",4,"ngIf"],[4,"ngIf"],[3,"amount","order"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.YNc(1,I,1,2,"app-payment-completion",1),t.YNc(2,M,1,0,"app-payment-confirmation",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf","Waiting For Payment"==a.paymentStatus),t.xp6(1),t.Q6J("ngIf","Paid"==a.paymentStatus))},styles:[".payment-main[_ngcontent-%COMP%]{display:grid;margin:1rem 2.5rem;grid-gap:.8rem;gap:.8rem}"]}),n})();const Z=[{path:"payment/:id",component:f}];let O=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[s.Bz.forChild(Z)],s.Bz]}),n})(),S=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.ez,O,P.m]]}),n})();t.B6R(f,[p.O5,d,b],[]),t.B6R(d,[v],[p.H9])}}]);